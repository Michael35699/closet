var Closet=function(t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,r)};function r(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}function n(t,e){var r,n,u,i,o={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(u=2&i[0]?n.return:i[0]?n.throw||((u=n.return)&&u.call(n),0):n.next)&&!(u=u.call(n,i[1])).done)return u;switch(n=0,u&&(i=[2&i[0],u.value]),i[0]){case 0:case 1:u=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(u=o.trys,(u=u.length>0&&u[u.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!u||i[1]>u[0]&&i[1]<u[3])){o.label=i[1];break}if(6===i[0]&&o.label<u[1]){o.label=u[1],u=i;break}if(u&&o.label<u[2]){o.label=u[2],o.ops.push(i);break}u[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],n=0}finally{r=u=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function u(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function i(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,u,i=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(t){u={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(u)throw u.error}}return o}function o(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t}var a,s=function(t,e){if(0===e.length)return t;for(var r=i(e),n=r[0],u=n.sep,o=n.max,a=n.trim,c=r.slice(1),l=t,f=[],p=1;0!==l.length&&p<o;p++){var h=l.indexOf(u),d=i(h>=0?[l.slice(0,h),l.slice(h+u.length)]:[l,""],2),v=d[0],g=d[1];f.push(a?v.trim():v),l=g}return 0!==l.length&&f.push(l),0===c.length?f:f.map((function(t){return s(t,c)}))},c=function(t){var e,r,n;return"string"==typeof t?{sep:t,max:1/0,trim:!1}:{sep:null!==(e=t.sep)&&void 0!==e?e:"::",max:null!==(r=t.max)&&void 0!==r?r:1/0,trim:null!==(n=t.trim)&&void 0!==n&&n}};!function(t){t[t.Ready=0]="Ready",t[t.NotReady=1]="NotReady",t[t.ContainsTags=2]="ContainsTags"}(a||(a={}));var l=function(t,e){return t&&e.isReady()},f=function(){function t(t,e,r,n,u,i){this._separators=[],this.fullKey=t,this.key=e,this.num=r,this.fullOccur=n,this.occur=u,this.innerNodes=i}return Object.defineProperty(t.prototype,"valuesText",{get:function(){return this.innerNodes.map((function(t){return t.toString()})).join("")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){return s(this.valuesText,this._separators)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separators",{set:function(t){this._separators=t.map(c)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separator",{get:function(){return this.separators},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"[["+this.fullKey+"::"+this.valuesText+"]]"},t.prototype.isReady=function(){return!1},t.prototype.getDefaultRepresentation=function(){return this.toString()},t.prototype.getRawRepresentation=function(){return this.valuesText},t.prototype.evaluate=function(t,e,r){var n,u=e(this.key),i=r.length-1,s=u.getOptions().capture;s||(n=this.innerNodes).splice.apply(n,o([0,this.innerNodes.length],this.innerNodes.flatMap((function(n,u){return n.evaluate(t,e,o(r,[u]))}))));var c=this.innerNodes.reduce(l,!0);this.separators=u.getOptions().separators;var f={path:r,depth:i,ready:c,capture:s},h=u.execute(this,f);switch(h.status){case a.NotReady:return[this];case a.Ready:return[new p(h.result)];case a.ContainsTags:return t.rawParse(h.result)}},t}(),p=function(){function t(t){this.text=t}return t.prototype.toString=function(){return this.text},t.prototype.isReady=function(){return!0},t.prototype.evaluate=function(){return[this]},t}(),h=function(){function t(){}return t.prototype.toString=function(){return null},t.prototype.isReady=function(){return!0},t.prototype.evaluate=function(){return[this]},t}(),d="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function v(t,e){return t(e={exports:{}},e.exports),e.exports}var g=v((function(t){var e,r;e=d,r=function(){function t(e,r,n){return this.id=++t.highestId,this.name=e,this.symbols=r,this.postprocess=n,this}function e(t,e,r,n){this.rule=t,this.dot=e,this.reference=r,this.data=[],this.wantedBy=n,this.isComplete=this.dot===t.symbols.length}function r(t,e){this.grammar=t,this.index=e,this.states=[],this.wants={},this.scannable=[],this.completed={}}function n(t,e){this.rules=t,this.start=e||this.rules[0].name;var r=this.byName={};this.rules.forEach((function(t){r.hasOwnProperty(t.name)||(r[t.name]=[]),r[t.name].push(t)}))}function u(){this.reset("")}function i(t,e,i){if(t instanceof n){var o=t;i=e}else o=n.fromCompiled(t,e);for(var a in this.grammar=o,this.options={keepHistory:!1,lexer:o.lexer||new u},i||{})this.options[a]=i[a];this.lexer=this.options.lexer,this.lexerState=void 0;var s=new r(o,0);this.table=[s],s.wants[o.start]=[],s.predict(o.start),s.process(),this.current=0}function o(t){var e=typeof t;if("string"===e)return t;if("object"===e){if(t.literal)return JSON.stringify(t.literal);if(t instanceof RegExp)return t.toString();if(t.type)return"%"+t.type;if(t.test)return"<"+String(t.test)+">";throw new Error("Unknown symbol type: "+t)}}return t.highestId=0,t.prototype.toString=function(t){var e=void 0===t?this.symbols.map(o).join(" "):this.symbols.slice(0,t).map(o).join(" ")+" ● "+this.symbols.slice(t).map(o).join(" ");return this.name+" → "+e},e.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},e.prototype.nextState=function(t){var r=new e(this.rule,this.dot+1,this.reference,this.wantedBy);return r.left=this,r.right=t,r.isComplete&&(r.data=r.build(),r.right=void 0),r},e.prototype.build=function(){var t=[],e=this;do{t.push(e.right.data),e=e.left}while(e.left);return t.reverse(),t},e.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,i.fail))},r.prototype.process=function(t){for(var e=this.states,r=this.wants,n=this.completed,u=0;u<e.length;u++){var o=e[u];if(o.isComplete){if(o.finish(),o.data!==i.fail){for(var a=o.wantedBy,s=a.length;s--;){var c=a[s];this.complete(c,o)}if(o.reference===this.index){var l=o.rule.name;(this.completed[l]=this.completed[l]||[]).push(o)}}}else{if("string"!=typeof(l=o.rule.symbols[o.dot])){this.scannable.push(o);continue}if(r[l]){if(r[l].push(o),n.hasOwnProperty(l)){var f=n[l];for(s=0;s<f.length;s++){var p=f[s];this.complete(o,p)}}}else r[l]=[o],this.predict(l)}}},r.prototype.predict=function(t){for(var r=this.grammar.byName[t]||[],n=0;n<r.length;n++){var u=r[n],i=this.wants[t],o=new e(u,0,this.index,i);this.states.push(o)}},r.prototype.complete=function(t,e){var r=t.nextState(e);this.states.push(r)},n.fromCompiled=function(e,r){var u=e.Lexer;e.ParserStart&&(r=e.ParserStart,e=e.ParserRules);var i=new n(e=e.map((function(e){return new t(e.name,e.symbols,e.postprocess)})),r);return i.lexer=u,i},u.prototype.reset=function(t,e){this.buffer=t,this.index=0,this.line=e?e.line:1,this.lastLineBreak=e?-e.col:0},u.prototype.next=function(){if(this.index<this.buffer.length){var t=this.buffer[this.index++];return"\n"===t&&(this.line+=1,this.lastLineBreak=this.index),{value:t}}},u.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},u.prototype.formatError=function(t,e){var r=this.buffer;if("string"==typeof r){var n=r.split("\n").slice(Math.max(0,this.line-5),this.line),u=r.indexOf("\n",this.index);-1===u&&(u=r.length);var i=this.index-this.lastLineBreak,o=String(this.line).length;return e+=" at line "+this.line+" col "+i+":\n\n",e+=n.map((function(t,e){return a(this.line-n.length+e+1,o)+" "+t}),this).join("\n"),e+="\n"+a("",o+i)+"^\n"}return e+" at index "+(this.index-1);function a(t,e){var r=String(t);return Array(e-r.length+1).join(" ")+r}},i.fail={},i.prototype.feed=function(t){var e,n=this.lexer;for(n.reset(t,this.lexerState);;){try{if(!(e=n.next()))break}catch(t){var i=new r(this.grammar,this.current+1);throw this.table.push(i),(s=new Error(this.reportLexerError(t))).offset=this.current,s.token=t.token,s}var o=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var a=this.current+1;i=new r(this.grammar,a),this.table.push(i);for(var s,c=void 0!==e.text?e.text:e.value,l=n.constructor===u?e.value:e,f=o.scannable,p=f.length;p--;){var h=f[p],d=h.rule.symbols[h.dot];if(d.test?d.test(l):d.type?d.type===e.type:d.literal===c){var v=h.nextState({data:l,token:e,isToken:!0,reference:a-1});i.states.push(v)}}if(i.process(),0===i.states.length)throw(s=new Error(this.reportError(e))).offset=this.current,s.token=e,s;this.options.keepHistory&&(o.lexerState=n.save()),this.current++}return o&&(this.lexerState=n.save()),this.results=this.finish(),this},i.prototype.reportLexerError=function(t){var e,r,n=t.token;return n?(e="input "+JSON.stringify(n.text[0])+" (lexer error)",r=this.lexer.formatError(n,"Syntax error")):(e="input (lexer error)",r=t.message),this.reportErrorCommon(r,e)},i.prototype.reportError=function(t){var e=(t.type?t.type+" token: ":"")+JSON.stringify(void 0!==t.value?t.value:t),r=this.lexer.formatError(t,"Syntax error");return this.reportErrorCommon(r,e)},i.prototype.reportErrorCommon=function(t,e){var r=[];r.push(t);var n=this.table.length-2,u=this.table[n],i=u.states.filter((function(t){var e=t.rule.symbols[t.dot];return e&&"string"!=typeof e}));return 0===i.length?(r.push("Unexpected "+e+". I did not expect any more input. Here is the state of my parse table:\n"),this.displayStateStack(u.states,r)):(r.push("Unexpected "+e+". Instead, I was expecting to see one of the following:\n"),i.map((function(t){return this.buildFirstStateStack(t,[])||[t]}),this).forEach((function(t){var e=t[0],n=e.rule.symbols[e.dot],u=this.getSymbolDisplay(n);r.push("A "+u+" based on:"),this.displayStateStack(t,r)}),this)),r.push(""),r.join("\n")},i.prototype.displayStateStack=function(t,e){for(var r,n=0,u=0;u<t.length;u++){var i=t[u],o=i.rule.toString(i.dot);o===r?n++:(n>0&&e.push("    ^ "+n+" more lines identical to this"),n=0,e.push("    "+o)),r=o}},i.prototype.getSymbolDisplay=function(t){return function(t){var e=typeof t;if("string"===e)return t;if("object"===e){if(t.literal)return JSON.stringify(t.literal);if(t instanceof RegExp)return"character matching "+t;if(t.type)return t.type+" token";if(t.test)return"token matching "+String(t.test);throw new Error("Unknown symbol type: "+t)}}(t)},i.prototype.buildFirstStateStack=function(t,e){if(-1!==e.indexOf(t))return null;if(0===t.wantedBy.length)return[t];var r=t.wantedBy[0],n=[t].concat(e),u=this.buildFirstStateStack(r,n);return null===u?null:[t].concat(u)},i.prototype.save=function(){var t=this.table[this.current];return t.lexerState=this.lexerState,t},i.prototype.restore=function(t){var e=t.index;this.current=e,this.table[e]=t,this.table.splice(e+1),this.lexerState=t.lexerState,this.results=this.finish()},i.prototype.rewind=function(t){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[t])},i.prototype.finish=function(){var t=[],e=this.grammar.start;return this.table[this.table.length-1].states.forEach((function(r){r.rule.name===e&&r.dot===r.rule.symbols.length&&0===r.reference&&r.data!==i.fail&&t.push(r)})),t.map((function(t){return t.data}))},{Parser:i,Grammar:n,Rule:t}},t.exports?t.exports=r():e.nearley=r()})),m=v((function(t){var e,r;e=d,r=function(){var t=Object.prototype.hasOwnProperty,e=Object.prototype.toString,r="boolean"==typeof(new RegExp).sticky;function n(t){return t&&"[object RegExp]"===e.call(t)}function u(t){return t&&"object"==typeof t&&!n(t)&&!Array.isArray(t)}function i(t){return"("+t+")"}function o(t){return t.length?"(?:"+t.map((function(t){return"(?:"+t+")"})).join("|")+")":"(?!)"}function a(t){if("string"==typeof t)return"(?:"+t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+")";if(n(t)){if(t.ignoreCase)throw new Error("RegExp /i flag not allowed");if(t.global)throw new Error("RegExp /g flag is implied");if(t.sticky)throw new Error("RegExp /y flag is implied");if(t.multiline)throw new Error("RegExp /m flag is implied");return t.source}throw new Error("Not a pattern: "+t)}function s(e,r){if(u(r)||(r={match:r}),r.include)throw new Error("Matching rules cannot also include states");var i={defaultType:e,lineBreaks:!!r.error||!!r.fallback,pop:!1,next:null,push:null,error:!1,fallback:!1,value:null,type:null,shouldThrow:!1};for(var o in r)t.call(r,o)&&(i[o]=r[o]);if("string"==typeof i.type&&e!==i.type)throw new Error("Type transform cannot be a string (type '"+i.type+"' for token '"+e+"')");var a=i.match;return i.match=Array.isArray(a)?a:a?[a]:[],i.match.sort((function(t,e){return n(t)&&n(e)?0:n(e)?-1:n(t)?1:e.length-t.length})),i}function c(t){return Array.isArray(t)?function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];if(n.include)for(var u=[].concat(n.include),i=0;i<u.length;i++)e.push({include:u[i]});else{if(!n.type)throw new Error("Rule has no type: "+JSON.stringify(n));e.push(s(n.type,n))}}return e}(t):function(t){for(var e=Object.getOwnPropertyNames(t),r=[],n=0;n<e.length;n++){var i=e[n],o=t[i],a=[].concat(o);if("include"!==i){var c=[];a.forEach((function(t){u(t)?(c.length&&r.push(s(i,c)),r.push(s(i,t)),c=[]):c.push(t)})),c.length&&r.push(s(i,c))}else for(var l=0;l<a.length;l++)r.push({include:a[l]})}return r}(t)}var l=s("error",{lineBreaks:!0,shouldThrow:!0});function f(t,e){for(var u=null,s=Object.create(null),c=!0,f=null,p=[],h=[],d=0;d<t.length;d++)t[d].fallback&&(c=!1);for(d=0;d<t.length;d++){var v=t[d];if(v.include)throw new Error("Inheritance is not allowed in stateless lexers");if(v.error||v.fallback){if(u)throw!v.fallback==!u.fallback?new Error("Multiple "+(v.fallback?"fallback":"error")+" rules not allowed (for token '"+v.defaultType+"')"):new Error("fallback and error are mutually exclusive (for token '"+v.defaultType+"')");u=v}var g=v.match.slice();if(c)for(;g.length&&"string"==typeof g[0]&&1===g[0].length;)s[g.shift().charCodeAt(0)]=v;if(v.pop||v.push||v.next){if(!e)throw new Error("State-switching options are not allowed in stateless lexers (for token '"+v.defaultType+"')");if(v.fallback)throw new Error("State-switching options are not allowed on fallback tokens (for token '"+v.defaultType+"')")}if(0!==g.length){c=!1,p.push(v);for(var m=0;m<g.length;m++){var y=g[m];if(n(y))if(null===f)f=y.unicode;else if(f!==y.unicode&&!1===v.fallback)throw new Error("If one rule is /u then all must be")}var b=o(g.map(a)),A=new RegExp(b);if(A.test(""))throw new Error("RegExp matches empty string: "+A);if(new RegExp("|"+b).exec("").length-1>0)throw new Error("RegExp has capture groups: "+A+"\nUse (?: … ) instead");if(!v.lineBreaks&&A.test("\n"))throw new Error("Rule should declare lineBreaks: "+A);h.push(i(b))}}var x=u&&u.fallback,w=r&&!x?"ym":"gm",F=r||x?"":"|";return!0===f&&(w+="u"),{regexp:new RegExp(o(h)+F,w),groups:p,fast:s,error:u||l}}function p(t,e,r){var n=t&&(t.push||t.next);if(n&&!r[n])throw new Error("Missing state '"+n+"' (in token '"+t.defaultType+"' of state '"+e+"')");if(t&&t.pop&&1!=+t.pop)throw new Error("pop must be 1 (in token '"+t.defaultType+"' of state '"+e+"')")}var h=function(t,e){this.startState=e,this.states=t,this.buffer="",this.stack=[],this.reset()};h.prototype.reset=function(t,e){return this.buffer=t||"",this.index=0,this.line=e?e.line:1,this.col=e?e.col:1,this.queuedToken=e?e.queuedToken:null,this.queuedThrow=e?e.queuedThrow:null,this.setState(e?e.state:this.startState),this.stack=e&&e.stack?e.stack.slice():[],this},h.prototype.save=function(){return{line:this.line,col:this.col,state:this.state,stack:this.stack.slice(),queuedToken:this.queuedToken,queuedThrow:this.queuedThrow}},h.prototype.setState=function(t){if(t&&this.state!==t){this.state=t;var e=this.states[t];this.groups=e.groups,this.error=e.error,this.re=e.regexp,this.fast=e.fast}},h.prototype.popState=function(){this.setState(this.stack.pop())},h.prototype.pushState=function(t){this.stack.push(this.state),this.setState(t)};var d=r?function(t,e){return t.exec(e)}:function(t,e){var r=t.exec(e);return 0===r[0].length?null:r};function v(){return this.value}if(h.prototype._getGroup=function(t){for(var e=this.groups.length,r=0;r<e;r++)if(void 0!==t[r+1])return this.groups[r];throw new Error("Cannot find token type for matched text")},h.prototype.next=function(){var t=this.index;if(this.queuedGroup){var e=this._token(this.queuedGroup,this.queuedText,t);return this.queuedGroup=null,this.queuedText="",e}var r=this.buffer;if(t!==r.length){if(o=this.fast[r.charCodeAt(t)])return this._token(o,r.charAt(t),t);var n=this.re;n.lastIndex=t;var u=d(n,r),i=this.error;if(null==u)return this._token(i,r.slice(t,r.length),t);var o=this._getGroup(u),a=u[0];return i.fallback&&u.index!==t?(this.queuedGroup=o,this.queuedText=a,this._token(i,r.slice(t,u.index),t)):this._token(o,a,t)}},h.prototype._token=function(t,e,r){var n=0;if(t.lineBreaks){var u=/\n/g,i=1;if("\n"===e)n=1;else for(;u.exec(e);)n++,i=u.lastIndex}var o={type:"function"==typeof t.type&&t.type(e)||t.defaultType,value:"function"==typeof t.value?t.value(e):e,text:e,toString:v,offset:r,lineBreaks:n,line:this.line,col:this.col},a=e.length;if(this.index+=a,this.line+=n,0!==n?this.col=a-i+1:this.col+=a,t.shouldThrow)throw new Error(this.formatError(o,"invalid syntax"));return t.pop?this.popState():t.push?this.pushState(t.push):t.next&&this.setState(t.next),o},"undefined"!=typeof Symbol&&Symbol.iterator){var g=function(t){this.lexer=t};g.prototype.next=function(){var t=this.lexer.next();return{value:t,done:!t}},g.prototype[Symbol.iterator]=function(){return this},h.prototype[Symbol.iterator]=function(){return new g(this)}}return h.prototype.formatError=function(t,e){if(null==t){var r=this.buffer.slice(this.index);t={text:r,offset:this.index,lineBreaks:-1===r.indexOf("\n")?0:1,line:this.line,col:this.col}}var n=Math.max(0,t.offset-t.col+1),u=t.lineBreaks?t.text.indexOf("\n"):t.text.length,i=this.buffer.substring(n,t.offset+u);return e+=" at line "+t.line+" col "+t.col+":\n\n",e+="  "+i+"\n",e+="  "+Array(t.col).join(" ")+"^"},h.prototype.clone=function(){return new h(this.states,this.state)},h.prototype.has=function(t){return!0},{compile:function(t){var e=f(c(t));return new h({start:e},"start")},states:function(t,e){var r=t.$all?c(t.$all):[];delete t.$all;var n=Object.getOwnPropertyNames(t);e||(e=n[0]);for(var u=Object.create(null),i=0;i<n.length;i++)u[b=n[i]]=c(t[b]).concat(r);for(i=0;i<n.length;i++)for(var o=u[b=n[i]],a=Object.create(null),s=0;s<o.length;s++){var l=o[s];if(l.include){var d=[s,1];if(l.include!==b&&!a[l.include]){a[l.include]=!0;var v=u[l.include];if(!v)throw new Error("Cannot include nonexistent state '"+l.include+"' (in state '"+b+"')");for(var g=0;g<v.length;g++){var m=v[g];-1===o.indexOf(m)&&d.push(m)}}o.splice.apply(o,d),s--}}var y=Object.create(null);for(i=0;i<n.length;i++){var b;y[b=n[i]]=f(u[b],!0)}for(i=0;i<n.length;i++){var A=n[i],x=y[A],w=x.groups;for(s=0;s<w.length;s++)p(w[s],A,y);var F=Object.getOwnPropertyNames(x.fast);for(s=0;s<F.length;s++)p(x.fast[F[s]],A,y)}return new h(y,e)},error:Object.freeze({error:!0}),fallback:Object.freeze({fallback:!0}),keywords:function(t){for(var e=Object.create(null),r=Object.create(null),n=Object.getOwnPropertyNames(t),u=0;u<n.length;u++){var i=n[u],o=t[i];(Array.isArray(o)?o:[o]).forEach((function(t){if((r[t.length]=r[t.length]||[]).push(t),"string"!=typeof t)throw new Error("keyword must be string (in keyword '"+i+"')");e[t]=i}))}function a(t){return JSON.stringify(t)}var s="";for(var c in s+="switch (value.length) {\n",r){var l=r[c];s+="case "+c+":\n",s+="switch (value) {\n",l.forEach((function(t){var r=e[t];s+="case "+a(t)+": return "+a(r)+"\n"})),s+="}\n"}return s+="}\n",Function("value",s)}}},t.exports?t.exports=r():e.moo=r()})).states({main:{tagopen:{match:"[[",push:"key"},text:{match:/[\s\S]+?(?=\[\[|$)/u,lineBreaks:!0}},key:{keyname:{match:/[a-zA-Z0-9%\/]+\d*/u},sep:{match:"::",next:"intag"},tagclose:{match:"]]",pop:1}},intag:{tagopen:{match:"[[",push:"key"},tagclose:{match:"]]",pop:1},text:{match:/[\s\S]+?(?=\[\[|\]\])/u,lineBreaks:!0}}}),y=/^(.+?)([0-9]*)$/u,b=function(t,e){var r,n=(null!==(r=t.get(e))&&void 0!==r?r:-1)+1;return t.set(e,n),n};function A(t){return t[0]}var x,w=new(function(){function t(){this.tagCounter=null,this.tagCounterFull=null}return t.prototype.increment=function(t,e){return[b(this.tagCounterFull,t),b(this.tagCounter,e)]},t.prototype.build=function(t,e){var r=t.match(y);if(!r)throw new Error("Could not match key. This should never happen.");var n=r[1],u=0===r[2].length?null:Number(r[2]),o=i(this.increment(t,n),2),a=o[0],s=o[1];return new f(t,n,u,a,s,e)},t.prototype.push=function(t){this.tagCounterFull=t[0],this.tagCounter=t[1]},t}()),F={Lexer:m,ParserRules:[{name:"start",symbols:["content"],postprocess:A},{name:"content$ebnf$1",symbols:[]},{name:"content$ebnf$1",symbols:["content$ebnf$1","node"],postprocess:function(t){return t[0].concat([t[1]])}},{name:"content",symbols:["content$ebnf$1"],postprocess:A},{name:"node",symbols:["text"],postprocess:A},{name:"node",symbols:["tag"],postprocess:A},{name:"text",symbols:[m.has("text")?{type:"text"}:text],postprocess:function(t){var e=i(t,1)[0];return new p(e.value)}},{name:"tag",symbols:[m.has("tagopen")?{type:"tagopen"}:tagopen,m.has("keyname")?{type:"keyname"}:keyname,"inner",m.has("tagclose")?{type:"tagclose"}:tagclose],postprocess:function(t){var e=i(t,3),r=e[1],n=e[2];return w.build(r.value,n)}},{name:"inner$ebnf$1$subexpression$1",symbols:[m.has("sep")?{type:"sep"}:sep,"content"]},{name:"inner$ebnf$1",symbols:["inner$ebnf$1$subexpression$1"],postprocess:A},{name:"inner$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"inner",symbols:["inner$ebnf$1"],postprocess:function(t){var e=i(t,1)[0];return e?e[1]:[]}}],ParserStart:"start"},E=function(t){var e=function(t){var e=new g.Parser(g.Grammar.fromCompiled(F));try{return e.feed(t).results}catch(e){return[[new p(t)]]}}(t);return e.length,e[0]},B=function(t){return o(function(t,e){var r,i,o,a,s,c,l,f,p,h,d,v;return n(this,(function(n){switch(n.label){case 0:r=!0,n.label=1;case 1:n.trys.push([1,14,15,16]),i=u(t),o=i.next(),n.label=2;case 2:return o.done?[3,13]:(a=o.value,r?(r=!1,[3,5]):[3,3]);case 3:return[4,e];case 4:n.sent(),n.label=5;case 5:n.trys.push([5,10,11,12]),d=void 0,s=u(a),c=s.next(),n.label=6;case 6:return c.done?[3,9]:[4,c.value];case 7:n.sent(),n.label=8;case 8:return c=s.next(),[3,6];case 9:return[3,12];case 10:return l=n.sent(),d={error:l},[3,12];case 11:try{c&&!c.done&&(v=s.return)&&v.call(s)}finally{if(d)throw d.error}return[7];case 12:return o=i.next(),[3,2];case 13:return[3,16];case 14:return f=n.sent(),p={error:f},[3,16];case 15:try{o&&!o.done&&(h=i.return)&&h.call(i)}finally{if(p)throw p.error}return[7];case 16:return[2]}}))}(t.map(E),new h))};!function(t){t[t.Single=1]="Single",t[t.Fragments=2]="Fragments"}(x||(x={}));var S,C,k,D,N,O,T,I,_=function(){function t(){this.tagBuilderSettings=[new Map,new Map]}return t.prototype.parse=function(t){return w.push(this.tagBuilderSettings),B(t)},t.prototype.rawParse=function(t){return w.push(this.tagBuilderSettings),E(t)},t}(),z=function(){function t(t,e){this.textFragments=t,this.parser=new _,this.nodes=null!=e?e:this.parser.parse(t)}return t.make=function(e){return new t([e],null)},t.makeFromFragments=function(e){return new t(e,null)},t.prototype.render=function(t,e){for(var r=this,n={template:this,parser:this.parser},i=this.nodes,o=!1,a=function(e){var u={iteration:e},a=t.makeAccessor(n,u);i=i.flatMap((function(t,e){return t.evaluate(r.parser,a,[e])})),o=i.reduce(l,!0),t.finishIteration(n,u)},s=0;s<50&&!o;s++)a(s);var c=function(t){var e,r,n=[],i="";try{for(var o=u(t),a=o.next();!a.done;a=o.next()){var s=a.value.toString();"string"==typeof s?i+=s:(n.push(i),i="")}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n.push(i),n}(i);return e&&e(c),t.finishRun(n,{result:c}),c},t}(),j=function(t,e,r){return t<0?r+t+1:e+t},P=function(t,e){var r;if("string"==typeof t)return t;switch(t.nodeType){case Node.TEXT_NODE:return null!==(r=t.textContent)&&void 0!==r?r:"";case Node.ELEMENT_NODE:var n=t;return e?n.outerHTML:n.innerHTML;case M.CHILD_NODE_SPAN:return t.spanAsStrings().join("");default:return""}},R={type:"index",value:0},L={type:"index",value:-1},M=function(){function t(e,r,n){var u,i,o,a;void 0===r&&(r=R),void 0===n&&(n=L),this.nodeType=t.CHILD_NODE_SPAN,this.parentElement=e,this.childNodes=Array.from(this.parentElement.childNodes),this.max=e.childNodes.length-1;var s=this.getFromMethod(r.type),c=this.getToMethod(n.type);this._fromIndex=s.call(this,r.value,null!==(u=r.startAtIndex)&&void 0!==u?u:0,null!==(i=r.exclusive)&&void 0!==i&&i),this._toIndex=c.call(this,n.value,Math.max(null!==(o=n.startAtIndex)&&void 0!==o?o:0,this.from),null!==(a=n.exclusive)&&void 0!==a&&a)}return Object.defineProperty(t.prototype,"from",{get:function(){return this._fromIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"to",{get:function(){return this._toIndex},enumerable:!1,configurable:!0}),t.prototype.getFromMethod=function(t){return"index"===t?this.fromIndex:"node"===t?this.fromNode:this.fromPredicate},t.prototype.getToMethod=function(t){return"index"===t?this.toIndex:"node"===t?this.toNode:this.toPredicate},t.prototype.fromSafe=function(t,e){return t<e||t>this.max?this.max:t},t.prototype.fromIndex=function(t,e,r){var n=j(t,e,this.max)+(r?1:0);return this.fromSafe(n,e)},t.prototype.fromNode=function(t,e,r){var n=this.childNodes.slice(e).findIndex((function(e){return e===t}))+e+(r?1:0);return this.fromSafe(n,e)},t.prototype.fromPredicate=function(t,e,r){var n=this.childNodes.slice(e).findIndex(t)+e+(r?1:0);return this.fromSafe(n,e)},t.prototype.toSafe=function(t,e){return t<e||t>this.max?0:t},t.prototype.toIndex=function(t,e,r){var n=j(t,e,this.max)-(r?1:0);return this.toSafe(n,e)},t.prototype.toNode=function(t,e,r){var n=this.childNodes.slice(e).findIndex((function(e){return e===t}))+e-(r?1:0);return this.toSafe(n,e)},t.prototype.toPredicate=function(t,e,r){var n=this.childNodes.slice(e).findIndex(t)+e-(r?1:0);return this.toSafe(n,e)},Object.defineProperty(t.prototype,"valid",{get:function(){return this._fromIndex<=this._toIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return Math.max(0,this._toIndex-this._fromIndex+1)},enumerable:!1,configurable:!0}),t.prototype.span=function(){return this.valid?this.childNodes.slice(this._fromIndex,this._toIndex+1):[]},t.prototype.spanAsStrings=function(){return this.span().map((function(t){return P(t,!0)}))},t.prototype.replaceSpan=function(t){var e,r;if(this.valid){var n=document.createElement("div"),i=this.parentElement.childNodes.length;this.parentElement.insertBefore(n,this.parentElement.childNodes[this._fromIndex]);try{for(var o=u(this.span()),a=o.next();!a.done;a=o.next()){var s=a.value;this.parentElement.removeChild(s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}n.outerHTML=t,this.childNodes=Array.from(this.parentElement.childNodes),this.max=this.childNodes.length,this._toIndex=this._toIndex+(this.max-i)}},t.CHILD_NODE_SPAN=3353,t}(),$=function(t,e){return void 0===e&&(e=0),[{type:"predicate",value:t.value,startAtIndex:e,exclusive:!1},{type:"predicate",value:function(e){return!t.value(e)},startAtIndex:e,exclusive:!0}]},H=function(t){function e(e,r,n){var u=t.call(this,e,r)||this;return u.inputs=n,u}return r(e,t),e.prototype.renderToNodes=function(e){var r=this;t.prototype.render.call(this,e,(function(t){return t.forEach((function(t,e){return function(t,e){if("string"!=typeof t)switch(t.nodeType){case Node.TEXT_NODE:var r=t,n=document.createElement("div");r.parentElement&&(r.parentElement.insertBefore(n,r),r.parentElement.removeChild(r)),n.outerHTML=e;break;case Node.ELEMENT_NODE:t.innerHTML=e;break;case M.CHILD_NODE_SPAN:t.replaceSpan(e)}}(r.inputs[e],t)}))}))},e.makeFromNode=function(t){return new e([P(t,!1)],null,[t])},e.makeFromNodes=function(t){return new e(t.map((function(t){return P(t,!1)})),null,t)},e}(z),q=function(){function t(t,e){this.filters=t,this.options=e}return t.prototype.register=function(t,e,r){void 0===r&&(r={}),this.filters.register(t,e),this.options.set(t,r)},t.prototype.getOptions=function(t){return this.options.get(t,{})},t}(),K=function(){function t(t,e,r,n,u,i,o,a){this.preset=t,this.filters=e,this.options=r,this.registrar=new q(e,r),this.deferred=n,this.aftermath=u,this.cache=i,this.memory=o,this.environment=a}return t.prototype.getBaseInternals=function(t){return Object.assign({},{filters:this.filters,options:this.options,registrar:this.registrar,cache:this.cache,memory:this.memory,environment:this.environment,deferred:this.deferred,aftermath:this.aftermath,preset:this.preset},t)},t.prototype.getAftermathInternals=function(t,e){return Object.assign(this.getBaseInternals(t),e)},t.prototype.getDeferredInternals=function(t,e){return Object.assign(this.getBaseInternals(t),e)},t.prototype.getInternals=function(t,e,r){return Object.assign(this.getDeferredInternals(t,e),r)},t.prototype.filterAccessor=function(t,e){var r=this;return{getProcessor:function(n){return{execute:function(u,i){return r.filters.execute(n,u,r.getInternals(t,e,i))},getOptions:function(){return r.options.get(n,{})}}}}},t.prototype.executeDeferred=function(t,e){var r=this.getDeferredInternals(t,e);this.deferred.executeEach(r)},t.prototype.executeAftermath=function(t,e){var r=this.getAftermathInternals(t,e);this.aftermath.executeEach(r)},t.prototype.switchPreset=function(t){this.preset=t},t.prototype.clear=function(){this.memory.clear(),this.aftermath.clear()},t.prototype.reset=function(){this.cache.clear(),this.deferred.clear()},t.prototype.addRecipe=function(t){t(this.registrar)},t}(),X=function(t,e){return{ready:e,result:t,containsTags:!1}},Y=function(t){return X(t,!0)},G={ready:!1,result:"",containsTags:!1},U=function(t,e){return r=t.getDefaultRepresentation(),n=e.ready,X(r,n);var r,n},W=function(t){return Y(t.getRawRepresentation())},J=function(){function t(){this.filters=new Map,this.register("raw",W)}return t.prototype.register=function(t,e){this.filters.set(t,e)},t.prototype.has=function(t){return this.filters.has(t)},t.prototype.get=function(t){var e;return null!==(e=this.filters.get(t))&&void 0!==e?e:null},t.prototype.getOrDefault=function(t){var e;return null!==(e=this.get(t))&&void 0!==e?e:U},t.prototype.unregisterFilter=function(t){this.filters.delete(t)},t.prototype.clearFilters=function(){this.filters.clear()},t.prototype.execute=function(t,e,r){return function(t){var e,r,n;switch(typeof t){case"string":return Y(t);case"object":return{ready:null===(e=t.ready)||void 0===e||e,result:null!==(r=t.result)&&void 0!==r?r:"",containsTags:null!==(n=t.containsTags)&&void 0!==n&&n};default:return G}}(this.getOrDefault(t)(e,r))},t}(),V=function(){function t(t){this.storage=t}return t.prototype.set=function(t,e){this.storage.set(t,e)},t.prototype.has=function(t){return this.storage.has(t)},t.prototype.get=function(t,e){var r;return null!==(r=this.storage.get(t))&&void 0!==r?r:e},t.prototype.fold=function(t,e,r){var n=e(this.get(t,r));return this.set(t,n),n},t.prototype.post=function(t,e,r){var n=this.get(t,r);return this.set(t,e(n)),n},t.prototype.lazy=function(t,e){return this.get(t,null)||this.fold(t,e,null)},t.prototype.over=function(t,e,r){var n=this.get(t,r);this.set(t,n),e(n)},t.prototype.delete=function(t){this.storage.delete(t)},t.prototype.clear=function(){this.storage.clear()},t}(),Z=function(t){return(t+1>>>1)-1},Q=function(t){return 1+(t<<1)},tt=function(t){return t+1<<1},et=function(){function t(t){this._heap=[],this._comparator=t}return t.prototype.greater=function(t,e){return this._comparator(this._heap[t],this._heap[e])},t.prototype.swap=function(t,e){var r;r=i([this._heap[e],this._heap[t]],2),this._heap[t]=r[0],this._heap[e]=r[1]},t.prototype.siftUp=function(){for(var t=this.size()-1;t>0&&this.greater(t,Z(t));)this.swap(t,Z(t)),t=Z(t)},t.prototype.siftDown=function(){for(var t=0;Q(t)<this.size()&&this.greater(Q(t),t)||tt(t)<this.size()&&this.greater(tt(t),t);){var e=tt(t)<this.size()&&this.greater(tt(t),Q(t))?tt(t):Q(t);this.swap(t,e),t=e}},t.prototype.size=function(){return this._heap.length},t.prototype.isEmpty=function(){return 0===this.size()},t.prototype.peek=function(){return this._heap[0]},t.prototype.push=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.forEach((function(e){t._heap.push(e),t.siftUp()})),this.size()},t.prototype.pop=function(){var t=this.peek(),e=this.size()-1;return e>0&&this.swap(0,e),this._heap.pop(),this.siftDown(),t},t.prototype.generate=function(){var t;return n(this,(function(e){switch(e.label){case 0:t=this.pop(),e.label=1;case 1:return t?[4,t]:[3,3];case 2:return e.sent(),t=this.pop(),[3,1];case 3:return[2,null]}}))},t}(),rt={priority:0,persistent:!1},nt=function(t,e){return t.priority>e.priority},ut=function(){function t(){this._deferred=new Map,this._blocked=new Set}return t.prototype.register=function(t,e,r){var n,u;void 0===r&&(r=rt),this._deferred.set(t,{keyword:t,procedure:e,priority:null!==(n=r.priority)&&void 0!==n?n:rt.priority,persistent:null!==(u=r.persistent)&&void 0!==u?u:rt.persistent})},t.prototype.registerIfNotExists=function(t,e,r){void 0===r&&(r=rt),this.isRegistered(t)||this.register(t,e,r)},t.prototype.unregister=function(t){this._deferred.delete(t)},t.prototype.isRegistered=function(t){return this._deferred.has(t)},t.prototype.block=function(t){this._blocked.add(t)},t.prototype.unblock=function(t){this._blocked.delete(t)},t.prototype.isBlocked=function(t){return this._blocked.has(t)},t.prototype.clear=function(){this._deferred.clear(),this._blocked.clear()},t.prototype.executeEach=function(t){var e,r,n=new et(nt);n.push.apply(n,o(this._deferred.values()));try{for(var i=u(n.generate()),a=i.next();!a.done;a=i.next()){var s=a.value;this.isBlocked(s.keyword)||s.procedure(s,t),s.persistent||this.unregister(s.keyword)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}this._blocked.clear()},t}(),it=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.make=function(t,r){void 0===t&&(t={}),void 0===r&&(r=new Map);var n=globalThis.hasOwnProperty("_closetEnvironment")?globalThis._closetEnvironment:globalThis._closetEnvironment=new Map;return new e(t,new J,new V(new Map),new ut,new ut,new V(new Map),new V(r),new V(n))},e.prototype.makeAccessor=function(e,r){var n=this,u=this.filterAccessor(e,r);return function(i){var o=u.getProcessor(i);return{execute:function(u,i){return(s=o.execute(u,t.prototype.getInternals.call(n,e,r,i))).ready?{status:s.containsTags?a.ContainsTags:a.Ready,result:s.result}:{status:a.NotReady,result:null};var s},getOptions:function(){return function(t){var e,r;return{separators:null!==(e=t.separators)&&void 0!==e?e:[],capture:null!==(r=t.capture)&&void 0!==r&&r}}(o.getOptions())}}}},e.prototype.finishIteration=function(t,e){this.executeDeferred(t,e)},e.prototype.finishRun=function(t,e){this.executeAftermath(t,e),this.reset()},e}(K),ot=function(t){return t},at=function(t,e){return e},st="A-Za-z\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B4\\u08B6-\\u08BD\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0AF9\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58-\\u0C5A\\u0C60\\u0C61\\u0C80\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D54-\\u0D56\\u0D5F-\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16F1-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u1884\\u1887-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1C80-\\u1C88\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FD5\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA7AE\\uA7B0-\\uA7B7\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA8FD\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB65\\uAB70-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC",ct="0-9\\xB2\\xB3\\xB9\\xBC-\\xBE\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u09F4-\\u09F9\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0B72-\\u0B77\\u0BE6-\\u0BF2\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0CE6-\\u0CEF\\u0D58-\\u0D5E\\u0D66-\\u0D78\\u0DE6-\\u0DEF\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F33\\u1040-\\u1049\\u1090-\\u1099\\u1369-\\u137C\\u16EE-\\u16F0\\u17E0-\\u17E9\\u17F0-\\u17F9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19DA\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\u2070\\u2074-\\u2079\\u2080-\\u2089\\u2150-\\u2182\\u2185-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2CFD\\u3007\\u3021-\\u3029\\u3038-\\u303A\\u3192-\\u3195\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\uA620-\\uA629\\uA6E6-\\uA6EF\\uA830-\\uA835\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uA9F0-\\uA9F9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19",lt=new RegExp("["+st+"]","gu"),ft=new RegExp("["+ct+"]","gu"),pt=new RegExp("["+st+ct+"]","gu"),ht=function(t,e){var r,n,i,o,a=[];try{for(var s=u(e),c=s.next();!c.done;c=s.next()){var l=t[d=c.value];l&&a.push(l)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}if(e.length<t.length){var f=Array.from(new Array(t.length-e.length),(function(t,r){return r+e.length}));try{for(var p=u(f),h=p.next();!h.done;h=p.next()){var d=h.value;a.push(t[d])}}catch(t){i={error:t}}finally{try{h&&!h.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}}return a},dt=function(){function t(t,e,r){this.separator=t,this.mapper=e,this.processor=r}return t.make=function(e){var r=void 0===e?{}:e,n=r.separator,u=void 0===n?", ":n,i=r.mapper,o=void 0===i?ot:i,a=r.processor;return new t(u,o,void 0===a?ot:a)},t.prototype.toStylizer=function(e){var r=void 0===e?{}:e,n=r.separator,u=void 0===n?this.separator:n,i=r.mapper,o=void 0===i?this.mapper:i,a=r.processor;return new t(u,o,void 0===a?this.processor:a)},t.prototype.stylize=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return this.processor(t.flatMap((function(t,n,u){return e.mapper.apply(e,o([t,n],r.map((function(t){return t[n]})),[u]))})).join(this.separator))},t}(),vt=function(t,e,r,n){return function(u,i){var o=t+":apply",a=t+":length",s=e+":waitingSet",c=e+":shuffle";if(i.cache.get(o,!1)){if(i.cache.get(s,new Set).size>0)return;for(var l=[],f=i.cache.get(c,[]),p=i.cache.get(a,0),h=0;h<p;h++){var d=f.shift();d&&l.push(d)}return l}if(i.ready){var v=n(u,i);if(0===v.length)return v;i.cache.fold(c,(function(t){return t.concat(v)}),[]),i.cache.set(a,v.length),i.deferred.registerIfNotExists(o,(function(){i.cache.set(o,!0),i.cache.over(s,(function(e){return e.delete(t)}),new Set)}),{priority:65}),i.deferred.registerIfNotExists(c,(function(){i.cache.get(s,new Set).size>0||i.cache.fold(c,(function(t){var e=i.memory.fold(c,(function(t){return r(t,i.cache.get(c,[]).length)}),[]);return ht(t,e)}),[])}))}else i.cache.over(s,(function(e){return e.add(t)}),new Set)}},gt=function(t){return function(e,r){return function(n,u){var o=i(t(n,u),2),a=o[0],s=o[1];return vt(a,s,r,e)(n,u)}}},mt=gt((function(t,e){var r=t.fullKey,n=t.fullOccur;return[r+":"+n,r+":"+n]})),yt=gt((function(t,e){var r=t.fullKey;return[r+":"+t.fullOccur,r]})),bt=function(t,e){if(t.length>=e)return t;var r=function(t){for(var e=t.slice(0),r=t.length;0!==r;){var n=Math.floor(Math.random()*r),u=e[r-=1];e[r]=e[n],e[n]=u}return e}(Array.from(new Array(e-t.length),(function(e,r){return r+t.length})));return o(t,r)},At=/^([a-zA-Z0-9%\/]*?)([0-9]*|\*)$/u,xt=function(t){return{get:function(){return t}}},wt=function(){function t(t){this.defaultValue=t,this.map=new Map}return t.prototype.getComponents=function(e){var r=i(e.split(":"),2),n=r[0],u=r[1],o=i(n.match(At),3),a=o[1],s=o[2];return[""===a?t.all:a,"*"===s?t.all:0===s.length?null:Number(s),u?Number(u):t.all]},t.prototype.getStoreKey=function(e,r,n){return""+(e===t.all?"":String(e))+(r===t.all?"*":null===r?"":String(r))+":"+(n===t.all?"all":String(n))},t.prototype.get=function(e,r,n){var u,i,o,a=this.getStoreKey(e,r,n);if(this.map.has(a))return null!==(u=this.map.get(a))&&void 0!==u?u:this.defaultValue;var s=this.getStoreKey(e,r,t.all);if(this.map.has(s))return null!==(i=this.map.get(s))&&void 0!==i?i:this.defaultValue;var c=this.getStoreKey(e,t.all,t.all);return null!==(o=this.map.get(c))&&void 0!==o?o:this.defaultValue},t.prototype.set=function(t,e,r,n){this.map.set(this.getStoreKey(t,e,r),n)},t.prototype.has=function(t,e,r){this.map.has(this.getStoreKey(t,e,r))},t.all=Symbol(),t}(),Ft=function(t){return function(e,r,n){return function(u,i){var a=i.cache;return u.values.forEach((function(u){a.over(e,n.apply(void 0,o(u)),new t(r))})),{ready:!0}}}},Et=function(t,e,r,n){return t-r<=e&&e<=t+n},Bt=function(t,e){var r=t.key,n=t.num,u=t.fullOccur,i=e.preset,o=e.cache,a=xt(0);switch(n){case null:return!1;case 0:return!0;default:if("number"!=typeof i.cardNumber)return!1;var s=o.get("flashcardActiveBottom",a).get(r,i.cardNumber,u),c=o.get("flashcardActiveTop",a).get(r,i.cardNumber,u);return Et(i.cardNumber,n,s,c)}},St=function(t,e){return e.cache.get("flashcardActive",xt(!1)).get(t.key,t.num,t.fullOccur)},Ct=function(t,e){return St(t,e)||Bt(t,e)},kt=function(t,e){return"back"===e.preset.side},Dt=kt,Nt=Object.freeze({__proto__:null,isActiveWithinRange:Et,isActive:function(t,e){var r=t.num,n=e.preset;switch(r){case null:return!1;case 0:return!0;default:return!!n.hasOwnProperty("cardNumber")&&r===n.cardNumber}},isActiveGetRange:Bt,isActiveOverwritten:St,isActiveAll:Ct,isBack:kt,isBackAll:Dt}),Ot=xt(!1),Tt=xt(0),It=function(t,e){var r=e.cache,n=e.preset;if(!n.cardNumber)return[0,0,0,0];return[r.get("flashcardShowBottom",Tt).get(t.key,n.cardNumber,t.fullOccur),r.get("flashcardShowTop",Tt).get(t.key,n.cardNumber,t.fullOccur),r.get("flashcardHideBottom",Tt).get(t.key,n.cardNumber,t.fullOccur),r.get("flashcardHideTop",Tt).get(t.key,n.cardNumber,t.fullOccur)]},_t=function(t){return function(e){return function(r,n){return function(u,i){return i.cache.get("flashcardShow",Ot).get(u.key,u.num,u.fullOccur)?r(u,i):i.cache.get("flashcardHide",Ot).get(u.key,u.num,u.fullOccur)?n(u,i):t(e)(r,n)(u,i)}}}}((S=function(t){return function(e,r){return function(n,u){return t(e,r)(n,u)}}},function(t){return function(e,r){return function(n,u){if(!u.preset.hasOwnProperty("cardNumber"))return S(t)(e,r)(n,u);var o=i(It(n,u),4),a=o[0],s=o[1],c=o[2],l=o[3],f=u.preset.cardNumber;return f&&n.num?f-a<=n.num&&n.num<=f+s?e(n,u):f-c<=n.num&&n.num<=f+l?r(n,u):S(t)(e,r)(n,u):t(e,r)(n,u)}}})),zt=function(t){return t.hasOwnProperty("tagname")?[t.tagname]:[]},jt=function(t,e){return t.tagname=e[0]},Pt=function(t){return function(e,r){var n=void 0===r?{wrapId:"wrapped",getTagnames:zt,setTagnames:jt}:r,i=n.wrapId,o=n.getTagnames,a=n.setTagnames;return function(r){return void 0===r&&(r={}),function(n){var s,c,l=o(r),f=function(t){return t+":"+i+":internal"},p=new Map,h=l.map((function(t){var e=f(t);return p.set(t,e),e}));a(r,h),e(r)(n);var d=function(e,r){var n=p.get(e.key);return t(Object.assign({},e,{keyInternal:n}),r),r.filters.getOrDefault(n)(e,r)};try{for(var v=u(l),g=v.next();!g.done;g=v.next()){var m=g.value;n.register(m,d,n.getOptions(f(m)))}}catch(t){s={error:t}}finally{try{g&&!g.done&&(c=v.return)&&c.call(v)}finally{if(s)throw s.error}}}}}},Rt=function(t){return function(e,r,n){return void 0===n&&(n={wrapId:"wrapped",getTagnames:zt,setTagnames:jt}),Pt((function(e,n){t(n).registerIfNotExists(e.keyInternal,r)}))(e,n)}},Lt=Rt((function(t){return t.deferred})),Mt=Rt((function(t){return t.aftermath})),$t=function(t,e,r,n){var u=void 0===n?{wrapId:"sum",getTagnames:zt,setTagnames:jt}:n,i=u.wrapId,o=u.setTagnames;return function(n){var u=void 0===n?{}:n,a=u.tagname,s=void 0===a?"sum":a,c=u.optionsFalse,l=void 0===c?{}:c,f=u.optionsTrue,p=void 0===f?{}:f;return function(n){var u=s+":"+i+":true",a=s+":"+i+":false";o(p,[u]),o(l,[a]),e(p)(n),t(l)(n);n.register(s,(function(t,e){return r(t,e)?e.filters.getOrDefault(u)(t,e):e.filters.getOrDefault(a)(t,e)}),n.getOptions(u))}}},Ht=function(t,e,r,n,u,i,o){var a=void 0===o?{wrapId:"sumFour",getTagnames:zt,setTagnames:jt}:o,s=a.wrapId,c=a.setTagnames;return function(o){var a=void 0===o?{}:o,l=a.tagname,f=void 0===l?"sum":l,p=a.optionsZero,h=void 0===p?{}:p,d=a.optionsOne,v=void 0===d?{}:d,g=a.optionsTwo,m=void 0===g?{}:g,y=a.optionsThree,b=void 0===y?{}:y;return function(o){var a=f+":"+s+":zero",l=f+":"+s+":two";c(h,[a]),c(v,[a]),$t(t,e,u)({tagname:a,optionsFalse:h,optionsTrue:v})(o),c(m,[l]),c(b,[l]),$t(r,n,u)({tagname:l,optionsFalse:m,optionsTrue:b})(o);o.register(f,(function(t,e){return i(t,e)?e.filters.getOrDefault(l)(t,e):e.filters.getOrDefault(a)(t,e)}))}}},qt=function(t){return function(e){var r=(void 0===e?{}:e).tagname,n=void 0===r?"s":r;return function(e){e.register(n,t)}}},Kt=function(t,e,r){return void 0===t&&(t=Ct),void 0===e&&(e=Dt),void 0===r&&(r=_t),function(n,u){return function(i,o,a,s,c,l){return void 0===l&&(l={}),function(f){var p=i+":internal";Ht(qt(r(n)(s,c)),qt(o),qt(r(u)(s,c)),qt(a),t,e)({tagname:p})(f);f.register(i,(function(t,e){return e.filters.getOrDefault(p)(t,e)}),l)}}}},Xt=function(t){return[t(ot,ot),t(at,at),t(at,ot)]},Yt=(C="[...]",function(t){return C}),Gt=function(t){return Array.isArray(t[0])?t[0].map((function(e,r){return t.map((function(t){return t[r]}))})):[t]},Ut=function(t,e){return function(r,n){return n.ready?t.stylize.apply(t,o(Gt(e(r,n)))):{ready:!1}}},Wt=function(t,e){return function(r,n){if(!n.ready)return{ready:!1};var u=e(r,n);return u?t.stylize.apply(t,o(Gt(u))):{ready:!1}}},Jt=dt.make({processor:function(t){return'<span style="color: cornflowerblue;">'+t+"</span>"}}),Vt=Jt.toStylizer({mapper:function(t){return"["+t+"]"}}),Zt=function(t,e){var r;return[null!==(r=t.values[1])&&void 0!==r?r:"..."]},Qt=function(t,e){return{ready:e.ready,result:t.values[0]}},te=function(t,e){return[t.values[0]]},ee=(k=i(Xt((function(t,e){return function(r){void 0===r&&(r={});var n=r.tagname,u=void 0===n?"c":n,i=r.inactiveEllipser,o=void 0===i?Yt:i,a=r.frontStylizer,s=void 0===a?Vt:a,c=r.frontEllipser,l=void 0===c?Zt:c,f=r.backStylizer,p=void 0===f?Jt:f,h=r.backEllipser,d=void 0===h?te:h,v=r.separator,g=void 0===v?{sep:"::",max:2}:v,m=r.flashcardTemplate,y=void 0===m?Kt():m,b=Ut(s,l),A=Ut(p,d),x={separators:[g]};return y(t,e)(u,b,A,Qt,o,x)}})),3))[0],re=k[1],ne=k[2],ue=function(t,e){return t.values?t.values.flatMap((function(t,e){return t.map((function(t){return[t,e]}))})):[]},ie=function(t,e){return t.values[0]},oe=dt.make(),ae=oe.toStylizer({processor:function(t){return"( "+t+" )"},mapper:function(t){return'<span style="color: orange;">'+t+"</span>"}}),se=ae.toStylizer({mapper:function(t,e,r){return'<span style="color: '+(0===r?"lime":"red")+';">'+t+"</span>"}}),ce=(D=i(Xt((function(t,e){return function(r){void 0===r&&(r={});var n=r.tagname,u=void 0===n?"mc":n,i=r.frontStylizer,o=void 0===i?ae:i,a=r.backStylizer,s=void 0===a?se:a,c=r.inactiveStylizer,l=void 0===c?oe:c,f=r.contexter,p=void 0===f?ie:f,h=r.ellipser,d=void 0===h?Yt:h,v=r.getValues,g=void 0===v?ue:v,m=r.sequence,y=void 0===m?yt:m,b=r.sortInStrategy,A=void 0===b?bt:b,x=r.categorySeparator,w=void 0===x?{sep:"::"}:x,F=r.valueSeparator,E=void 0===F?{sep:"||"}:F,B=r.flashcardTemplate,S=void 0===B?Kt():B,C=y(g,A),k=Wt(o,C),D=Wt(s,C),N={separators:[w,E]};return S(t,e)(u,k,D,Ut(l,p),d,N)}})),3))[0],le=D[1],fe=D[2],pe=function(t,e){return t.values},he=dt.make({separator:", "}),de=dt.make({processor:function(t){return'<span style="color: cornflowerblue;">'+t+"</span>"}}),ve=function(t,e){return t.values?t.values:[]},ge=function(t,e){return Ut(t,pe)},me=function(t,e){return function(r,n){return function(u){void 0===u&&(u={});var i=u.tagname,o=void 0===i?"shuf":i,a=u.activeStylizer,s=void 0===a?de:a,c=u.inactiveStylizer,l=void 0===c?he:c,f=u.contexter,p=void 0===f?ve:f,h=u.ellipser,d=void 0===h?Yt:h,v=u.sequence,g=void 0===v?yt:v,m=u.sortInStrategy,y=void 0===m?bt:m,b=u.separator,A=void 0===b?{sep:"::"}:b,x=u.flashcardTemplate,w=void 0===x?Kt():x,F={separators:[A]},E=g(p,y),B=t(s,E),S=e(s,E),C=Ut(l,p);return w(r,n)(o,B,S,C,d,F)}}},ye=(N=i(Xt(me(Wt,Wt)),3))[0],be=N[1],Ae=N[2],xe=(O=i(Xt(me(Wt,ge)),3))[0],we=O[1],Fe=O[2],Ee=(T=i(Xt(me(ge,Wt)),3))[0],Be=T[1],Se=T[2],Ce=function(t,e){return function(r){var u=void 0===r?{}:r,o=u.tagname,a=void 0===o?"gen":o,s=u.uniqueConstraintId,c=void 0===s?"uniq":s,l=u.separator,f=void 0===l?{sep:","}:l;return function(r){var u=function(t){return function(e,r,u,i,o){var a,s;return n(this,(function(n){switch(n.label){case 0:a=0,n.label=1;case 1:return i.length<r-e&&a<1e4?(s=t(e,r,u),o&&i.includes(s)?[3,3]:[4,s]):[3,4];case 2:n.sent(),i.push(s),n.label=3;case 3:return a++,[3,1];case 4:return[2]}}))}}(t),o="gen:"+c;r.register(a,(function(t,r){var n=t.values,s=t.fullOccur,c=t.num,l=r.memory,f=i(1===n.length?[1,Number(n[0]),e]:n.map(Number),3),p=f[0],h=void 0===p?1:p,d=f[1],v=void 0===d?100:d,g=f[2],m=void 0===g?e:g,y=Number.isInteger(c)?o+":"+c:o,b="gen:"+a+":"+s;return{ready:!0,result:l.lazy(b,(function(){return u(h,v,m,Number.isInteger(c)?l.get(y,[]):[],!0).next().value||""}))}}),{separators:[f]})}}},ke=Ce((function(t,e,r){return String((Math.floor(Math.random()*e)+t)*r)}),1),De=Ce((function(t,e,r){return(Math.random()*(e-t)+t).toFixed(r)}),2),Ne=/%(.)/gu,Oe={separators:[{sep:"::",max:2}],capture:!0},Te=Ft(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.on=function(t){var e=i(this.getComponents(t),3),r=e[0],n=e[1],u=e[2];this.set(r,n,u,!0)},e.prototype.off=function(t){var e=i(this.getComponents(t),3),r=e[0],n=e[1],u=e[2];this.set(r,n,u,!1)},e.prototype.toggle=function(t){var e=i(this.getComponents(t),3),r=e[0],n=e[1],u=e[2];this.set(r,n,u,!this.get(r,n,u))},e}(wt)),Ie={sep:"=",max:2},_e=Ft(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.setNumber=function(t,e){var r=i(this.getComponents(t),3),n=r[0],u=r[1],o=r[2];this.set(n,u,o,Number.isNaN(e)?0:e)},e.prototype.increment=function(t,e){var r=i(this.getComponents(t),3),n=r[0],u=r[1],o=r[2];this.set(n,u,o,this.get(n,u,o)+(Number.isNaN(e)?1:e))},e.prototype.decrement=function(t,e){var r=i(this.getComponents(t),3),n=r[0],u=r[1],o=r[2];this.set(n,u,o,this.get(n,u,o)-(Number.isNaN(e)?1:e))},e}(wt)),ze={shuffle:function(t){var e=void 0===t?{}:t,r=e.tagname,n=void 0===r?"mix":r,u=e.stylizer,i=void 0===u?dt.make():u,o=e.sortInStrategy,a=void 0===o?bt:o;return function(t){t.register(n,(function(t,e){var r=t.fullKey+":"+t.fullOccur,n=t.num?t.fullKey:r,u=vt(r,n,a,(function(t,e){var r=t.values;return null!=r?r:[]}))(t,e);if(u)return i.stylize(u)}),{separators:["||"]})}},order:function(t){var e=void 0===t?{}:t,r=e.tagname,n=void 0===r?"ord":r,o=e.separator,a=void 0===o?",":o,s=e.cmdSeparator,c=void 0===s?"::":s,l=e.sortInStrategy,f=void 0===l?bt:l;return function(t){t.register(n,(function(t,e){var r,n,o=e.deferred,a=e.cache,s=e.memory,c=function(e,r){var n=t.key+":ord:occupied:"+e,i=r.filter((function(t){return!a.get(n,[]).includes(t)}));a.fold(n,(function(t){return t.concat(i)}),[]);var c=new Set(i),l=t.key+":"+t.fullOccur+":ord:"+e;o.register(l,(function(){var t,e,r=function(t){o.block(t+":shuffle");var e=t+":shuffle";if(0!==a.get(t+":waitingSet",new Set).size)return"continue";var r=a.get(e,[]),n=f(a.get(l,s.get(e,[])),r.length);a.fold(e,(function(t){return ht(t,n)}),[]),c.delete(t),a.set(l,n),s.set(e,n)};try{for(var n=(t=void 0,u(c)),i=n.next();!i.done;i=n.next()){r(i.value)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}0===c.size&&o.unregister(l)}),{priority:35,persistent:!0})};try{for(var l=u(t.values.entries()),p=l.next();!p.done;p=l.next()){var h=i(p.value,2);c(h[0],h[1])}}catch(t){r={error:t}}finally{try{p&&!p.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return{ready:!0}}),{separators:[c,a]})}},shuffleShow:ye,shuffleHide:be,shuffleReveal:Ae,sortShow:xe,sortHide:we,sortReveal:Fe,jumbleShow:Ee,jumbleHide:Be,jumbleReveal:Se,generateInteger:ke,generateReal:De,clozeShow:ee,clozeHide:re,clozeReveal:ne,multipleChoiceShow:ce,multipleChoiceHide:le,multipleChoiceReveal:fe,process:function(t){var e=void 0===t?{}:t,r=e.tagname,n=void 0===r?"s":r,u=e.processor,i=void 0===u?ot:u;return function(t){t.register(n,(function(t){return i(t.values)}),{separators:[]})}},stylize:function(t){var e=void 0===t?{}:t,r=e.tagname,n=void 0===r?"s":r,u=e.stylizer,i=void 0===u?dt.make():u,o=e.separator,a=void 0===o?"::":o;return function(t){t.register(n,(function(t){return i.stylize(t.values)}),{separators:[a]})}},activate:function(t){var e=void 0===t?{}:t,r=e.tagname,n=void 0===r?"on":r,u=e.storeId,i=void 0===u?"active":u,o=e.separator,a=void 0===o?{sep:","}:o;return function(t){return t.register(n,Te(i,!1,(function(t){return function(e){e.on(t)}})),{separators:[a,Ie]})}},deactivate:function(t){var e=void 0===t?{}:t,r=e.tagname,n=void 0===r?"off":r,u=e.storeId,i=void 0===u?"active":u,o=e.separator,a=void 0===o?{sep:","}:o;return function(t){return t.register(n,Te(i,!1,(function(t){return function(e){return e.off(t)}})),{separators:[a,Ie]})}},toggle:function(t){var e=void 0===t?{}:t,r=e.tagname,n=void 0===r?"toggle":r,u=e.storeId,i=void 0===u?"active":u,o=e.separator,a=void 0===o?{sep:","}:o;return function(t){return t.register(n,Te(i,!1,(function(t){return function(e){return e.toggle(t)}})),{separators:[a,Ie]})}},setNumber:function(t){var e=void 0===t?{}:t,r=e.tagname,n=void 0===r?"set":r,u=e.storeId,i=void 0===u?"numerical":u,o=e.separator,a=void 0===o?{sep:","}:o,s=e.assignmentSeparator,c=void 0===s?{sep:"=",trim:!0}:s;return function(t){return t.register(n,_e(i,0,(function(t,e){return function(r){return r.setNumber(t,Number(e))}})),{separators:[a,c]})}},increment:function(t){var e=void 0===t?{}:t,r=e.tagname,n=void 0===r?"inc":r,u=e.storeId,i=void 0===u?"numerical":u,o=e.separator,a=void 0===o?{sep:","}:o,s=e.assignmentSeparator,c=void 0===s?{sep:"=",trim:!0}:s;return function(t){return t.register(n,_e(i,0,(function(t,e){return function(r){return r.increment(t,Number(e))}})),{separators:[a,c]})}},decrement:function(t){var e=void 0===t?{}:t,r=e.tagname,n=void 0===r?"dec":r,u=e.storeId,i=void 0===u?"numerical":u,o=e.separator,a=void 0===o?{sep:","}:o,s=e.assignmentSeparator,c=void 0===s?{sep:"=",trim:!0}:s;return function(t){return t.register(n,_e(i,0,(function(t,e){return function(r){return r.decrement(t,Number(e))}})),{separators:[a,c]})}},debug:function(){return function(t){t.register("tagpath",(function(t,e){return e.path.join(":")})),t.register("never",(function(){})),t.register("empty",(function(){return""})),t.register("key",(function(t){return t.key})),t.register("stopIteration",(function(t,e){var r=t.values,n=e.filters,u=Number(r),i=n.getOrDefault("base");return n.register("base",(function(t,e){var r;return e.iteration>=u?null!==(r=t.valuesText)&&void 0!==r?r:"":i(t,e)})),{ready:!0}})),t.register("memorytest",(function(t,e){var r=e.memory;return String(r.fold("base:memorytest",(function(t){return++t}),0))}))}},meta:function(){return function(t){var e={separators:[{sep:"::"}]};t.register("def",(function(r){var n=i(r.values,2),u=n[0],o=n[1];return t.register(u,(function(t){return{result:o.replace(Ne,function(t){return function(e,r){var n;switch(r){case"%":return r;case"n":return"number"==typeof t.num?String(t.num):"";case"k":return t.key;case"f":return t.fullKey;default:var u=Number(r);return Number.isNaN(u)?e:null!==(n=t.values[u])&&void 0!==n?n:""}}}(t)),containsTags:!0}}),e),{result:""}}),Oe)}}},je={wrap:Pt,deferred:Lt,aftermath:Mt,sum:$t,sumFour:Ht,product:function(t,e,r,n){void 0===r&&(r=function(){return function(){return{ready:!0}}});var u=void 0===n?{wrapId:"product",getTagnames:zt,setTagnames:jt}:n,i=u.wrapId,o=u.setTagnames;return function(n){var u=void 0===n?{}:n,a=u.tagname,s=void 0===a?"prod":a,c=u.optionsFirst,l=void 0===c?{}:c,f=u.optionsSecond,p=void 0===f?{}:f;return function(n){var u=s+":"+i+":fst",a=s+":"+i+":snd";o(l,[u]),o(p,[a]),t(l)(n),e(p)(n);n.register(s,(function(t,e){return r(e.filters.getOrDefault(u)(t,e),e.filters.getOrDefault(a)(t,e))(t,e)}),n.getOptions(u))}}}},Pe={withinTag:mt,acrossTag:yt},Re=function(t){return Number(t.match(/[0-9]*$/))},Le=Object.freeze({__proto__:null,getCardNumber:Re,preset:function(t,e,r){return{card:t,cardNumber:Re(t),tagsFull:e,tags:0===e.length?[]:e.split(" "),side:r}},memoryMap:function(t){var e,r=null!==(e=globalThis.Persistence)&&void 0!==e?e:null,n=function(t,e){if(t&&t.isAvailable()){var r=t.getItem(e);return new Map(r)}return new Map}(r,t);return{map:n,writeBack:function(){!function(t,e,r){if(t&&t.isAvailable()){var n=Array.from(r.entries());t.setItem(e,n)}}(r,t,n)}}},getQaChildNodes:function(){if(!window.document)return null;var t=window.document.getElementById("qa");return t?function(t,e){for(var r=[],n=new(M.bind.apply(M,o([void 0,t],$(e))));n.valid;)r.push(n),n=new(M.bind.apply(M,o([void 0,t],$(e,n.to+1))));return r}(t,{type:"predicate",value:function(t){return"STYLE"!==t.tagName&&"SCRIPT"!==t.tagName&&"anki-am"!==t.id}}):null}}),Me=function(t){var e=document.createElement("style");e.type="text/css",e.innerHTML=t,globalThis.document.head.appendChild(e)},$e=/<img[^>]*?src="(.+?)"[^>]*>/g,He=function(t){var e,r=[];do{(e=$e.exec(t))&&r.push(e[1])}while(e);return r},qe=function(t){return[t.layerX||t.offsetX,t.layerY||t.offsetY]},Ke=function(t,e){var r=document.querySelector(t);r&&(r.complete?e({target:r}):r.addEventListener("load",e))},Xe="\nimg {\n  max-width: 100% !important;\n}\n\n.closet__occlusion-container {\n  display: inline-block;\n  position: relative;\n}\n\n.closet__occlusion-container > * {\n  display: block;\n\n  margin-left: auto;\n  margin-right: auto;\n}\n\n.closet__occlusion-container > svg {\n  position: absolute;\n  top: 0;\n}\n\n.closet__occlusion-shape > text {\n  text-anchor: middle;\n  dominant-baseline: central;\n  pointer-events: none;\n}",Ye="http://www.w3.org/2000/svg",Ge=function(){function t(t,e,r){var n=this;this.constrainedFactorX=1,this.constrainedFactorY=1,this.zoomX=1,this.zoomY=1,this.elements=[],this.container=t,this.image=e,this.svg=r,this.resizer=new ResizeObserver((function(){return n.resize()})),this.resizer.observe(e),this.setScaleFactors()}return t.prototype.setScaleFactors=function(){this.constrainedFactorX=this.image.width/this.image.naturalWidth,this.constrainedFactorY=this.image.height/this.image.naturalHeight,this.zoomX=this.svg.clientWidth/this.image.width,this.zoomY=this.svg.clientHeight/this.image.height},t.wrapImage=function(e){var r=document.createElement("div");e.parentNode&&e.parentNode.replaceChild(r,e),r.appendChild(e);var n=document.createElementNS(Ye,"svg");return n.setAttributeNS(null,"width","100%"),n.setAttributeNS(null,"height","100%"),r.appendChild(n),r.classList.add("closet__occlusion-container"),new t(r,e,n)},Object.defineProperty(t.prototype,"scaleFactors",{get:function(){return[this.constrainedFactorX*this.zoomX,this.constrainedFactorY*this.zoomY]},enumerable:!1,configurable:!0}),t.prototype.resize=function(){var t,e;if(this.setScaleFactors(),this.scaleFactors.includes(0))this.resizer.disconnect();else try{for(var r=u(this.elements),n=r.next();!n.done;n=r.next()){n.value.resize(this)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t.prototype.append=function(t){var e,r;this.elements.push(t);try{for(var n=u(t.getElements()),i=n.next();!i.done;i=n.next()){var o=i.value;this.svg.appendChild(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t}(),Ue=function(){function t(t,e,r,n,u){this.container=t,this.rect=e,this.label=r,this.scalingFactorX=n,this.scalingFactorY=u}return t.make=function(e){var r=document.createElementNS(Ye,"svg"),n=document.createElementNS(Ye,"rect"),u=document.createElementNS(Ye,"text");r.appendChild(n),r.appendChild(u),r.classList.add("closet__occlusion-shape"),r.classList.add("closet__occlusion_rect"),r.tabIndex=-1;var o=i(e?e.scaleFactors:[1,1],2),a=new t(r,n,u,o[0],o[1]);return a.x=0,a.y=0,a.width=0,a.height=0,a.fill="moccasin",a.stroke="olive",a.strokeWidth=2,a},t.wrap=function(e,r){var n=i(r?r.scaleFactors:[1,1],2),u=n[0],o=n[1];return new t(e.parentElement,e,e.nextSibling,u,o)},t.prototype.prop=function(t,e){this[t]=e},t.prototype.remove=function(){this.container.remove()},t.prototype.getElements=function(){return[this.container]},t.prototype.resize=function(t){var e=this.pos,r=t.scaleFactors;this.scalingFactorX=r[0],this.scalingFactorY=r[1],this.pos=e},Object.defineProperty(t.prototype,"pos",{get:function(){return[this.x,this.y,this.width,this.height]},set:function(t){var e=i(t,4),r=e[0],n=e[1],u=e[2],o=e[3];this.width=u,this.height=o,this.x=r,this.y=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return Number(this.rect.getAttributeNS(null,"width"))/this.scalingFactorX},set:function(t){var e=String(Math.max(10,t)*this.scalingFactorX);this.rect.setAttributeNS(null,"width",e),this.label.setAttributeNS(null,"width",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return Number(this.rect.getAttributeNS(null,"height"))/this.scalingFactorY},set:function(t){var e=String(Math.max(10,t)*this.scalingFactorY);this.rect.setAttributeNS(null,"height",e),this.label.setAttributeNS(null,"height",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return Number(this.rect.getAttributeNS(null,"x"))/this.scalingFactorX},set:function(t){var e=t*this.scalingFactorX;this.rect.setAttributeNS(null,"x",String(e)),this.label.setAttributeNS(null,"x",String(e+this.width/2*this.scalingFactorX))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return Number(this.rect.getAttributeNS(null,"y"))/this.scalingFactorY},set:function(t){var e=t*this.scalingFactorY;this.rect.setAttributeNS(null,"y",String(e)),this.label.setAttributeNS(null,"y",String(e+this.height/2*this.scalingFactorY))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rx",{get:function(){return Number(this.rect.getAttributeNS(null,"rx"))},set:function(t){this.rect.setAttributeNS(null,"rx",String(t))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ry",{get:function(){return Number(this.rect.getAttributeNS(null,"ry"))},set:function(t){this.rect.setAttributeNS(null,"ry",String(t))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){var t;return null!==(t=this.rect.getAttributeNS(null,"fill"))&&void 0!==t?t:""},set:function(t){this.rect.setAttributeNS(null,"fill",t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillOpacity",{get:function(){return Number(this.rect.getAttributeNS(null,"fillOpacity"))},set:function(t){this.rect.setAttributeNS(null,"fillOpacity",String(t))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){var t;return null!==(t=this.rect.getAttributeNS(null,"stroke"))&&void 0!==t?t:""},set:function(t){this.rect.setAttributeNS(null,"stroke",t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeOpacity",{get:function(){return Number(this.rect.getAttributeNS(null,"strokeOpacity"))},set:function(t){this.rect.setAttributeNS(null,"strokeOpacity",String(t))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeWidth",{get:function(){return Number(this.rect.getAttributeNS(null,"strokeWidth"))},set:function(t){this.rect.setAttributeNS(null,"strokeWidth",String(t))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labelText",{get:function(){return this.label.innerHTML},set:function(t){this.label.innerHTML=t},enumerable:!1,configurable:!0}),t}(),We=function(t,e,r,n,u,o,a){return function(s){var c=i(qe(s),2),l=c[0],f=c[1];e&&l<o?(t.x=l,t.width=o-l):r&&(t.x=o,t.width=l-o),n&&f<a?(t.y=f,t.height=a-f):u&&(t.y=a,t.height=f-a)}},Je=function(t,e,r,n,u,i,o,a,s){return function(c,l,f){var p=l-c.x,h=c.x+c.width-l,d=f-c.y,v=c.y+c.height-f;return p<=5?d<=5?t(c):v<=5?e(c):r(c):h<=5?d<=5?n(c):v<=5?u(c):i(c):d<=5?o(c):v<=5?a(c):s(c)}},Ve=Je((function(t){return[!0,!1,!0,!1,t.x+t.width,t.y+t.height]}),(function(t){return[!0,!1,!1,!0,t.x+t.width,t.y]}),(function(t){return[!0,!1,!1,!1,t.x+t.width,0]}),(function(t){return[!1,!0,!0,!1,t.x,t.y+t.height]}),(function(t){return[!1,!0,!1,!0,t.x,t.y]}),(function(t){return[!1,!0,!1,!1,t.x,0]}),(function(t){return[!1,!1,!0,!1,0,t.y+t.height]}),(function(t){return[!1,!1,!1,!0,0,t.y]}),(function(){return[!1,!1,!1,!1,0,0]})),Ze=Je((function(){return"nwse-resize"}),(function(){return"nesw-resize"}),(function(){return"ew-resize"}),(function(){return"nesw-resize"}),(function(){return"nwse-resize"}),(function(){return"ew-resize"}),(function(){return"ns-resize"}),(function(){return"ns-resize"}),(function(){return"move"})),Qe=function(t){var e=Ue.wrap(t.target),r=e.rect;if(t.shiftKey)r.style.cursor="no-drop";else{var n=i(qe(t),2),u=n[0],o=n[1];r.style.cursor=Ze(e,u,o)}},tr=function(t){var e=document.createElement("li"),r=document.createElement("a");return r.innerText=t.label,r.id=t.itemId,r.classList.add("context-menu-item"),t.clickEvent&&r.addEventListener("click",t.clickEvent),e.appendChild(r),t.sub&&t.sub.length>0&&e.appendChild(er(t.sub)),e},er=function(t){var e,r,n=document.createElement("ul"),i=t.map(tr);try{for(var o=u(i),a=o.next();!a.done;a=o.next()){var s=a.value;n.appendChild(s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n},rr=function(t){return function(e){t.classList.remove("context-menu--active")}},nr=function(t,e){var r=rr(t);e.addEventListener("contextmenu",(function(e){e.preventDefault(),e.stopPropagation(),document.querySelectorAll(".context-menu--active").forEach((function(t){return t.classList.remove("context-menu--active")})),t.classList.add("context-menu--active"),window.addEventListener("click",r,{once:!0}),function(t,e,r){t.style.left=e+"px",t.style.top=r+"px"}(t,e.pageX,e.pageY)}))},ur=function(t,e){var r,n,u,i=(r=t,n=e,(u=document.createElement("nav")).classList.add("context-menu"),u.id=r,u.appendChild(er(n)),u);return document.body.insertAdjacentElement("beforeend",i),function(t){t.addEventListener("click",(function(t){t.stopPropagation()})),t.querySelectorAll("li").forEach((function(e){e.addEventListener("mouseenter",(function(){e.classList.add("context-menu--hover")})),e.addEventListener("mouseleave",(function(){e.classList.remove("context-menu--hover")})),e.addEventListener("click",(function(e){rr(t)(e)}))}))}(i),i},ir="occlusionRenderRect",or=function(t,e){var r=e.template,n=e.cache,o=e.environment,a=r.textFragments.flatMap(He),s=n.get(t.keyword,[]);o.post("occlusionSvgCss",(function(){return!0}),!1)||Me(Xe),Ke('img[src="'+a[0]+'"]',(function(t){var e,r,n=Ge.wrapImage(t.target);try{for(var o=u(s),a=o.next();!a.done;a=o.next()){var c=i(a.value,7),l=c[0],f=c[2],p=c[3],h=c[4],d=c[5],v=c[6];if(l){var g=Ue.make(n);for(var m in g.x=f,g.y=p,g.width=h,g.height=d,v){var y=m;g.prop(y,v[y])}n.append(g)}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}}))},ar=function(t,e){var r=t.fullKey,n=t.values,u=e.cache,o=i(n,4),a=o[0],s=void 0===a?0:a,c=o[1],l=void 0===c?0:c,f=o[2],p=void 0===f?50:f,h=o[3],d=void 0===h?p:h;return u.over(ir,(function(t){return t.push([!1,r,Number(s),Number(l),Number(p),Number(d),{}])}),[]),{ready:!0}},sr=function(t,e){var r=t.fullKey,n=t.values,u=e.cache,o=e.aftermath,a=i(n,4),s=a[0],c=void 0===s?0:s,l=a[1],f=void 0===l?0:l,p=a[2],h=void 0===p?50:p,d=a[3],v=void 0===d?h:d;return u.over(ir,(function(t){return t.push([!0,r,Number(c),Number(f),Number(h),Number(v),{}])}),[]),o.registerIfNotExists(ir,or),{ready:!0}},cr=function(t,e){var r=t.fullKey,n=t.values,u=e.cache,o=e.aftermath,a=i(n,4),s=a[0],c=void 0===s?0:s,l=a[1],f=void 0===l?0:l,p=a[2],h=void 0===p?50:p,d=a[3],v=void 0===d?h:d;return u.over(ir,(function(t){return t.push([!0,r,Number(c),Number(f),Number(h),Number(v),{fill:"salmon",stroke:"yellow"}])}),[]),o.registerIfNotExists(ir,or),{ready:!0}},lr=(I=i(Xt((function(t,e){return function(r){void 0===r&&(r={});var n=r.tagname,u=void 0===n?"rect":n,i=r.front,o=void 0===i?cr:i,a=r.back,s=void 0===a?ar:a,c=r.separator,l=void 0===c?{sep:","}:c,f=r.flashcardTemplate,p={separators:[l]};return(void 0===f?Kt():f)(t,e)(u,o,s,ar,sr,p)}})),3))[0],fr=I[1],pr=I[2],hr=function(t,e){var r=Ue.wrap(e.target);if(e.shiftKey)r.remove();else{var n=i(qe(e),2),u=n[0],a=n[1],s=Ve(r,u,a),c=s.includes(!0)?We.apply(void 0,o([r],s)):function(t,e,r,n,u){return function(o){var a=i(qe(o),2),s=a[0],c=a[1],l=e+(s-n),f=r+(c-u);t.x=l,t.y=f}}(r,r.x,r.y,u,a);t.svg.addEventListener("mousemove",c),t.svg.addEventListener("mouseup",(function(e){e.preventDefault(),t.svg.removeEventListener("mousemove",c)}),{once:!0})}},dr=function(t,e){e.rect.addEventListener("mousemove",Qe);var r=ur("occlusion-shape-menu",[{label:"Change Label",itemId:"change-label",clickEvent:function(){var t=prompt("Specify the new label",e.labelText);"string"==typeof t&&(e.labelText=t)}},{label:"Close Menu",itemId:"close-occlusion-menu"}]);nr(r,e.rect),t.append(e)},vr=function(t,e){e.preventDefault(),"svg"!==e.target.nodeName?hr(t,e):function(t,e){var r=i(qe(e),2),n=r[0],u=r[1],o=Ue.make();o.labelText="rect1",o.pos=[n,u,0,0],dr(t,o);var a=We(o,!0,!0,!0,!0,n,u);t.svg.addEventListener("mousemove",a),t.svg.addEventListener("mouseup",(function(){return t.svg.removeEventListener("mousemove",a)}))}(t,e)},gr=function(t){return[t.labelText,t.x,t.y,t.width,t.height]},mr=function(t){var e=i(t,5),r=e[0],n=e[1],u=e[2],o=e[3],a=e[4];return"[["+r+"::"+n.toFixed()+","+u.toFixed()+","+o.toFixed()+","+a.toFixed()+"]]"},yr=function(t,e){return navigator.clipboard.writeText(e.join("\n"))},br={appendStyleTag:Me},Ar={makeOcclusions:function(t){return void 0===t&&(t={}),function(e){var r=t.tagname,n=void 0===r?"makeOcclusions":r,a=t.occlusionTextHandler,s=void 0===a?yr:a,c=t.shapeKeywords,l=void 0===c?[ir]:c;e.register(n,(function(t,e){var r=e.template,n=e.cache,a=e.aftermath,c=e.environment,f=r.textFragments.flatMap(He);return a.registerIfNotExists("makeOcclusions",(function(){var t,e,r,p;c.post("occlusionMakerCss",(function(){return!0}),!1)||(Me("\n:root {\n  --cm-niceblue: #3f8cf1;\n  --cm-nicegray: #444;\n  --cm-backgray: #ececec;\n  --cm-boxgray: #cfcfcf;\n}\n\nnav.context-menu {\n  position: absolute;\n  z-index: 9999;\n  display: none;\n}\n\nnav.context-menu--active {\n  display: block;\n}\n\n/******************** UL */\n\nnav.context-menu ul {\n  position: absolute;\n\n  padding: 0.2rem 0;\n  width: 10rem;\n\n  white-space: nowrap;\n  list-style: none;\n\n  background-color: var(--cm-backgray);\n  border: solid 1px var(--cm-boxgray);\n  box-shadow: 1px 1px 2px var(--cm-boxgray);\n}\n\n/******************** LI */\n\nnav.context-menu li {\n  margin-bottom: 2px;\n}\n\nnav.context-menu li.context-menu--hover {\n  background-color: var(--cm-niceblue);\n}\n\nnav.context-menu li:last-child {\n  margin-bottom: 0;\n}\n\nnav.context-menu li ul {\n  display: none;\n  margin-left: 2rem;\n}\n\nnav.context-menu li.context-menu--hover ul {\n  display: block;\n}\n\nnav.context-menu li li ul {\n  display: none;\n  margin-left: 4rem;\n}\n\nnav.context-menu li li.context-menu--hover ul {\n  display: block;\n}\n\n/******************** A */\n\nnav.context-menu a {\n  display: block;\n  padding: 0.3rem 1rem;\n  user-select: none;\n\n  color: var(--cm-nicegray);\n}\n\nnav.context-menu li.context-menu--hover a {\n  color: white;\n}\n"),Me("\n.closet__occlusion-container {\n  outline: 3px dotted hotpink;\n}")),c.post("occlusionSvgCss",(function(){return!0}),!1)||Me(Xe);var h=[];try{for(var d=u(l),v=d.next();!v.done;v=d.next()){var g=v.value,m=n.get(g,[]);h.push.apply(h,o(m)),a.block(g)}}catch(e){t={error:e}}finally{try{v&&!v.done&&(e=d.return)&&e.call(d)}finally{if(t)throw t.error}}var y=function(t){var e,r,n=Ge.wrapImage(t.target);try{for(var o=u(h),a=o.next();!a.done;a=o.next()){var c=i(a.value,6),l=(c[0],c[1]),f=c[2],p=c[3],d=c[4],v=c[5],g=Ue.make(n);g.labelText=l,g.pos=[f,p,d,v],dr(n,g)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}!function(t,e){t.svg.addEventListener("mousedown",(function(e){0===e.button&&vr(t,e)}));var r=ur("occlusion-menu",[{label:"Accept occlusions",itemId:"occlusion-accept",clickEvent:function(r){r.preventDefault();var n=Array.from(t.svg.childNodes).map((function(t){return t.childNodes[0]})).map((function(e){return Ue.wrap(e,t)})).map(gr).map(mr);e(t.svg.childNodes,n)}},{label:"Close Menu",itemId:"close-occlusion-menu"}]);nr(r,t.svg)}(n,s)};try{for(var b=u(f),A=b.next();!A.done;A=b.next()){var x=A.value;Ke('img[src="'+x+'"]',y)}}catch(t){r={error:t}}finally{try{A&&!A.done&&(p=b.return)&&p.call(b)}finally{if(r)throw r.error}}}),{priority:100}),{ready:!0}}))}},rectShow:lr,rectHide:fr,rectReveal:pr};return t.BrowserTemplate=H,t.FilterManager=it,t.Parser=_,t.Stylizer=dt,t.Template=z,t.anki=Le,t.browser=br,t.browserRecipes=Ar,t.deciders=Nt,t.keyPattern=/^([a-zA-Z0-9%\/]+?)([0-9]*)$/u,t.recipes=ze,t.sequencers=Pe,t.unicodeAlphanumericPattern=pt,t.unicodeLetterPattern=lt,t.unicodeNumberPattern=ft,t.wrappers=je,t}({});
